<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Andrew Frick" />

<meta name="date" content="2019-02-12" />

<title>ajfhelpR_bools v1</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>

</head>

<body>




<h1 class="title toc-ignore">ajfhelpR_bools v1</h1>
<h4 class="author"><em>Andrew Frick</em></h4>
<h4 class="date"><em>2019-02-12</em></h4>



<p>One of the first “oops” mistakes I had in R had to do with T | NA == NA instead of false. While there are times when you don’t want to coerce that to false, I decided to create a new set of boolean operators for this case.</p>
<p>First we’ll look at the new <code>equal to</code> operator <code>%==%</code> by creating a data frame of boolean combinations</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co">#Create data frame/tibble with combination of all bools</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1-3" data-line-number="3">x =<span class="st"> </span><span class="kw">c</span>(T,F,<span class="ot">NA</span>)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"></a>
<a class="sourceLine" id="cb1-5" data-line-number="5">bools =<span class="st"> </span><span class="kw">as.tibble</span>(<span class="kw">expand.grid</span>(x,x))</a>
<a class="sourceLine" id="cb1-6" data-line-number="6"></a>
<a class="sourceLine" id="cb1-7" data-line-number="7">equals =<span class="st"> </span>bools <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">==</span><span class="st">`</span> =<span class="st"> </span>(Var1 <span class="op">==</span><span class="st"> </span>Var2),</a>
<a class="sourceLine" id="cb1-9" data-line-number="9">         <span class="st">`</span><span class="dt">%==%</span><span class="st">`</span> =<span class="st"> </span>(Var1 <span class="op">%==%</span><span class="st"> </span>Var2))</a></code></pre></div>
<p>Below you can see the difference in the output for the original <code>==</code> and the <code>%==%</code> extension.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">equals</a></code></pre></div>
<pre><code>## # A tibble: 9 x 4
##   Var1  Var2  `==`  `%==%`
##   &lt;lgl&gt; &lt;lgl&gt; &lt;lgl&gt; &lt;lgl&gt; 
## 1 TRUE  TRUE  TRUE  TRUE  
## 2 FALSE TRUE  FALSE FALSE 
## 3 NA    TRUE  NA    FALSE 
## 4 TRUE  FALSE FALSE FALSE 
## 5 FALSE FALSE TRUE  TRUE  
## 6 NA    FALSE NA    FALSE 
## 7 TRUE  NA    NA    FALSE 
## 8 FALSE NA    NA    FALSE 
## 9 NA    NA    NA    NA</code></pre>
<p>Here we’ll create another tibble containing the ‘venn diagram’ boolean operators</p>
<ol style="list-style-type: decimal">
<li><code>|</code> vs <code>%or%</code></li>
<li><code>&amp;</code> vs <code>%&amp;%</code></li>
</ol>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">Venns =<span class="st"> </span>bools <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">|</span><span class="st">`</span> =<span class="st"> </span>(Var1 <span class="op">|</span><span class="st"> </span>Var2),</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">         <span class="st">`</span><span class="dt">%or%</span><span class="st">`</span> =<span class="st"> </span>(Var1 <span class="op">%or%</span><span class="st"> </span>Var2),</a>
<a class="sourceLine" id="cb4-4" data-line-number="4">         <span class="st">`</span><span class="dt">&amp;</span><span class="st">`</span> =<span class="st"> </span>(Var1 <span class="op">&amp;</span><span class="st"> </span>Var2),</a>
<a class="sourceLine" id="cb4-5" data-line-number="5">         <span class="st">`</span><span class="dt">%&amp;%</span><span class="st">`</span> =<span class="st"> </span>(Var1 <span class="op">%&amp;%</span><span class="st"> </span>Var2))</a></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">Venns</a></code></pre></div>
<pre><code>## # A tibble: 9 x 6
##   Var1  Var2  `|`   `%or%` `&amp;`   `%&amp;%`
##   &lt;lgl&gt; &lt;lgl&gt; &lt;lgl&gt; &lt;lgl&gt;  &lt;lgl&gt; &lt;lgl&gt;
## 1 TRUE  TRUE  TRUE  TRUE   TRUE  TRUE 
## 2 FALSE TRUE  TRUE  TRUE   FALSE FALSE
## 3 NA    TRUE  TRUE  TRUE   NA    FALSE
## 4 TRUE  FALSE TRUE  TRUE   FALSE FALSE
## 5 FALSE FALSE FALSE FALSE  FALSE FALSE
## 6 NA    FALSE NA    FALSE  FALSE FALSE
## 7 TRUE  NA    TRUE  TRUE   NA    FALSE
## 8 FALSE NA    NA    FALSE  FALSE FALSE
## 9 NA    NA    NA    NA     NA    NA</code></pre>
<p>The equality operator also allows comparison of a single value vs a vector, it can be used for subsetting operations.</p>
<p>x[(condition)] returns all values where (condition) is not false. NA is not interpreted as false by R, so any rows with missing condition will be also be returned. To ensure your subset only returns those that are true, we can use the <code>%==%</code> operator to coerce those to false.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"></a>
<a class="sourceLine" id="cb7-3" data-line-number="3">y =<span class="st"> 'blue'</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"></a>
<a class="sourceLine" id="cb7-5" data-line-number="5">colors =<span class="st"> </span><span class="kw">c</span>(<span class="st">'blue'</span>, <span class="st">'red'</span>, <span class="st">'yellow'</span>, <span class="ot">NA</span>)</a>
<a class="sourceLine" id="cb7-6" data-line-number="6"></a>
<a class="sourceLine" id="cb7-7" data-line-number="7">colorsamp =<span class="st"> </span><span class="kw">sample</span>(colors, <span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="fl">0.4</span>,<span class="fl">0.2</span>,<span class="fl">0.1</span>,<span class="fl">0.3</span>),</a>
<a class="sourceLine" id="cb7-8" data-line-number="8">                   <span class="dt">replace =</span> T)</a>
<a class="sourceLine" id="cb7-9" data-line-number="9"></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"></a>
<a class="sourceLine" id="cb7-11" data-line-number="11">y  <span class="op">==</span><span class="st">  </span>colorsamp</a></code></pre></div>
<pre><code>##  [1] FALSE FALSE FALSE FALSE    NA  TRUE  TRUE    NA FALSE FALSE</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">y <span class="op">%==%</span><span class="st"> </span>colorsamp</a></code></pre></div>
<pre><code>##  [1] FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE FALSE FALSE FALSE</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">colorsamp[colorsamp <span class="op">==</span><span class="st"> </span>y]</a></code></pre></div>
<pre><code>## [1] NA     &quot;blue&quot; &quot;blue&quot; NA</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">colorsamp[colorsamp <span class="op">%==%</span><span class="st"> </span>y]</a></code></pre></div>
<pre><code>## [1] &quot;blue&quot; &quot;blue&quot;</code></pre>
<p>The <code>%==%</code> operator is especially useful for <code>ifelse</code> statements. Let’s say we change all y to 0 if x is not equal to ‘a’</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">12356</span>)</a>
<a class="sourceLine" id="cb15-2" data-line-number="2"></a>
<a class="sourceLine" id="cb15-3" data-line-number="3">tib =<span class="st"> </span><span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb15-4" data-line-number="4">  <span class="dt">x =</span> <span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="ot">NA</span>), <span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">replace =</span> T),</a>
<a class="sourceLine" id="cb15-5" data-line-number="5">  <span class="dt">y =</span> <span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">replace =</span> T)</a>
<a class="sourceLine" id="cb15-6" data-line-number="6">)</a>
<a class="sourceLine" id="cb15-7" data-line-number="7"></a>
<a class="sourceLine" id="cb15-8" data-line-number="8">tib</a></code></pre></div>
<pre><code>## # A tibble: 10 x 2
##    x         y
##    &lt;chr&gt; &lt;int&gt;
##  1 b         1
##  2 a         8
##  3 a         9
##  4 b         5
##  5 &lt;NA&gt;     10
##  6 &lt;NA&gt;      2
##  7 b         9
##  8 a         9
##  9 &lt;NA&gt;      9
## 10 b         2</code></pre>
<p>We see there are 3 rows with <code>NA</code>, and depending on how we wish to view the data in context, we could consider these to be 1. “not equal to a” or 2. “unknown.”</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">tib =<span class="st"> </span>tib <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">y %==%</span><span class="st">`</span> =<span class="st"> </span><span class="kw">ifelse</span>(x <span class="op">%==%</span><span class="st"> 'a'</span>, x, <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb17-3" data-line-number="3">         <span class="st">`</span><span class="dt">y ==</span><span class="st">`</span>   =<span class="st"> </span><span class="kw">ifelse</span>(x  <span class="op">==</span><span class="st">  'a'</span>, x, <span class="dv">0</span>))</a>
<a class="sourceLine" id="cb17-4" data-line-number="4"></a>
<a class="sourceLine" id="cb17-5" data-line-number="5">tib</a></code></pre></div>
<pre><code>## # A tibble: 10 x 4
##    x         y `y %==%` `y ==`
##    &lt;chr&gt; &lt;int&gt; &lt;chr&gt;    &lt;chr&gt; 
##  1 b         1 0        0     
##  2 a         8 a        a     
##  3 a         9 a        a     
##  4 b         5 0        0     
##  5 &lt;NA&gt;     10 0        &lt;NA&gt;  
##  6 &lt;NA&gt;      2 0        &lt;NA&gt;  
##  7 b         9 0        0     
##  8 a         9 a        a     
##  9 &lt;NA&gt;      9 0        &lt;NA&gt;  
## 10 b         2 0        0</code></pre>
<p>The <code>==</code> operator perceives <code>x == NA</code> as missing and outputs a value of missing for the new column. The <code>%==%</code> opertor coerces those missing booleans to F, and outputs the value of 0. Either of these approaches can be correct based on the context of the individual problem. But I’ve found in data that I work with, <code>%==%</code> tends to be more useful.</p>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
